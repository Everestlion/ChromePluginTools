function cancelEvent(a,b){a.returnValue=!1,a.preventDefault&&a.preventDefault(),b&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())}function DragResize(a,b){var c={myName:a,enabled:!0,handles:["tl","tm","tr","ml","mr","bl","bm","br"],isElement:null,isHandle:null,element:null,handle:null,minWidth:10,minHeight:10,minLeft:0,maxLeft:9999,minTop:0,maxTop:9999,zIndex:1,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,mOffX:0,mOffY:0,elmX:0,elmY:0,elmW:0,elmH:0,allowBlur:!0,ondragfocus:null,ondragstart:null,ondragmove:null,ondragend:null,ondragblur:null};for(var d in c)this[d]="undefined"==typeof b[d]?c[d]:b[d]}if("function"!=typeof addEvent){var addEvent=function(a,b,c,d){var e="addEventListener",f="on"+b,g=a,h=b,i=c,j=d;return a[e]&&!d?a[e](b,c,!1):(a._evts||(a._evts={}),a._evts[b]||(a._evts[b]=a[f]?{b:a[f]}:{},a[f]=new Function("e",'var r = true, o = this, a = o._evts["'+b+'"], i; for (i in a) {o._f = a[i]; r = o._f(e||window.event) != false && r; o._f = null;} return r'),"unload"!=b&&addEvent(window,"unload",function(){removeEvent(g,h,i,j)})),c._i||(c._i=addEvent._i++),void(a._evts[b][c._i]=c))};addEvent._i=1;var removeEvent=function(a,b,c,d){var e="removeEventListener";return a[e]&&!d?a[e](b,c,!1):void(a._evts&&a._evts[b]&&c._i&&delete a._evts[b][c._i])}}var obj,targetnode;DragResize.prototype.apply=function(a){obj=this,targetnode=a,addEvent(targetnode,"mousedown",function(a){obj.mouseDown(a)}),addEvent(targetnode,"mousemove",function(a){obj.mouseMove(a)})},DragResize.prototype.select=function(newElement){with(this){if(!document.getElementById||!enabled)return;newElement&&newElement!=element&&enabled&&(element=newElement,element.style.zIndex=++zIndex,this.resizeHandleSet&&this.resizeHandleSet(element,!0),elmX=parseInt(element.style.left),elmY=parseInt(element.style.top),elmW=element.offsetWidth,elmH=element.offsetHeight,ondragfocus&&this.ondragfocus())}},DragResize.prototype.deselect=function(delHandles){with(this){if(!document.getElementById||!enabled)return;delHandles&&(ondragblur&&this.ondragblur(),this.resizeHandleSet&&this.resizeHandleSet(element,!1),element=null),handle=null,mOffX=0,mOffY=0}},DragResize.prototype.mouseDown=function(e){with(this){if(!document.getElementById||!enabled)return!0;for(var elm=e.target||e.srcElement,newElement=null,newHandle=null,hRE=new RegExp(myName+"-([trmbl]{2})","");elm;){if(elm.className&&(newHandle||!hRE.test(elm.className)&&!isHandle(elm)||(newHandle=elm),isElement(elm))){newElement=elm;break}elm=elm.parentNode}element&&element!=newElement&&allowBlur&&deselect(!0),!newElement||element&&newElement!=element||(newHandle&&cancelEvent(e),select(newElement,newHandle),handle=newHandle,handle&&ondragstart&&this.ondragstart(hRE.test(handle.className))),mouseX=e.pageX||e.clientX+document.documentElement.scrollLeft,mouseY=e.pageY||e.clientY+document.documentElement.scrollTop,lastMouseX=mouseX,lastMouseY=mouseY,addEvent(targetnode,"mouseup",function(a){obj.mouseUp(a)})}},DragResize.prototype.mouseMove=function(e){with(this){if(!document.getElementById||!enabled)return!0;mouseX=e.pageX||e.clientX+document.documentElement.scrollLeft,mouseY=e.pageY||e.clientY+document.documentElement.scrollTop;var diffX=mouseX-lastMouseX+mOffX,diffY=mouseY-lastMouseY+mOffY;if(mOffX=mOffY=0,lastMouseX=mouseX,lastMouseY=mouseY,!handle)return!0;var isResize=!1;if(this.resizeHandleDrag&&this.resizeHandleDrag(diffX,diffY))isResize=!0;else{var dX=diffX,dY=diffY;minLeft>elmX+dX?mOffX=dX-(diffX=minLeft-elmX):elmX+elmW+dX>maxLeft&&(mOffX=dX-(diffX=maxLeft-elmX-elmW)),minTop>elmY+dY?mOffY=dY-(diffY=minTop-elmY):elmY+elmH+dY>maxTop&&(mOffY=dY-(diffY=maxTop-elmY-elmH)),elmX+=diffX,elmY+=diffY}with(element.style)left=elmX+"px",width=elmW+"px",top=elmY+"px",height=elmH+"px";if(window.opera&&document.documentElement){var oDF=document.getElementById("op-drag-fix");if(!oDF){var oDF=document.createElement("input");oDF.id="op-drag-fix",oDF.style.display="none",document.body.appendChild(oDF)}oDF.focus()}ondragmove&&this.ondragmove(isResize,e),cancelEvent(e)}},DragResize.prototype.mouseUp=function(e){with(this){if(!document.getElementById||!enabled)return;removeEvent(targetnode,"mousemove",function(a){obj.mouseMove(a)}),removeEvent(targetnode,"mouseup",function(a){obj.mouseUp(a)});var hRE=new RegExp(myName+"-([trmbl]{2})","");handle&&ondragend&&this.ondragend(hRE.test(handle.className)),deselect(!1)}},DragResize.prototype.resizeHandleSet=function(elm,show){with(this){if(!elm._handle_tr)for(var h=0;h<handles.length;h++){var hDiv=document.createElement("div");hDiv.className=myName+" "+myName+"-"+handles[h],elm["_handle_"+handles[h]]=elm.appendChild(hDiv)}for(var h=0;h<handles.length;h++)elm["_handle_"+handles[h]].style.visibility=show?"inherit":"hidden"}},DragResize.prototype.resizeHandleDrag=function(diffX,diffY){with(this){var hClass=handle&&handle.className&&handle.className.match(new RegExp(myName+"-([tmblr]{2})"))?RegExp.$1:"",dY=diffY,dX=diffX,processed=!1;return hClass.indexOf("t")>=0&&(rs=1,minHeight>elmH-dY?mOffY=dY-(diffY=elmH-minHeight):minTop>elmY+dY&&(mOffY=dY-(diffY=minTop-elmY)),elmY+=diffY,elmH-=diffY,processed=!0),hClass.indexOf("b")>=0&&(rs=1,minHeight>elmH+dY?mOffY=dY-(diffY=minHeight-elmH):elmY+elmH+dY>maxTop&&(mOffY=dY-(diffY=maxTop-elmY-elmH)),elmH+=diffY,processed=!0),hClass.indexOf("l")>=0&&(rs=1,minWidth>elmW-dX?mOffX=dX-(diffX=elmW-minWidth):minLeft>elmX+dX&&(mOffX=dX-(diffX=minLeft-elmX)),elmX+=diffX,elmW-=diffX,processed=!0),hClass.indexOf("r")>=0&&(rs=1,minWidth>elmW+dX?mOffX=dX-(diffX=minWidth-elmW):elmX+elmW+dX>maxLeft&&(mOffX=dX-(diffX=maxLeft-elmX-elmW)),elmW+=diffX,processed=!0),processed}};